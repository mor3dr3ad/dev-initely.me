<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Level 8 - My New Hugo Site</title><meta name="Description" content="This is my cool site"><meta property="og:url" content="http://localhost:1313/natas/level8/">
  <meta property="og:site_name" content="My New Hugo Site">
  <meta property="og:title" content="Level 8">
  <meta property="og:description" content="14:45:00&#43;01:00 draft = false &#43;&#43;&#43;
State “DONE” from [2025-03-27 Thu 14:45]&lt; Level 8 is a little tricky. We are asked to input a secret again and have a button showing the sourcecode. {{&lt; figure src=&#34;/ox-hugo/clipboard-20250224T233738.png&#34; &gt;}}
So let’s look at the sourcecode:
&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&#34;stylesheet&#34; type=&#34;text/css&#34; href=&#34;http://natas.labs.overthewire.org/css/level.css&#34;&gt; &lt;link rel=&#34;stylesheet&#34; href=&#34;http://natas.labs.overthewire.org/css/jquery-ui.css&#34; /&gt; &lt;link rel=&#34;stylesheet&#34; href=&#34;http://natas.labs.overthewire.org/css/wechall.css&#34; /&gt; &lt;script src=&#34;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&#34;&gt;&lt;/script&gt; &lt;script src=&#34;http://natas.labs.overthewire.org/js/jquery-ui.js&#34;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&#34;http://natas.labs.overthewire.org/js/wechall.js&#34;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &#34;level&#34;: &#34;natas8&#34;, &#34;pass&#34;: &#34;&lt;censored&gt;&#34; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas8&lt;/h1&gt; &lt;div id=&#34;content&#34;&gt; &lt;? $encodedSecret = &#34;3d3d516343746d4d6d6c315669563362&#34;; function encodeSecret($secret) { return bin2hex(strrev(base64_encode($secret))); } if(array_key_exists(&#34;submit&#34;, $_POST)) { if(encodeSecret($_POST[&#39;secret&#39;]) == $encodedSecret) { print &#34;Access granted. The password for natas9 is &lt;censored&gt;&#34;; } else { print &#34;Wrong secret&#34;; } } ?&gt; &lt;form method=post&gt; Input secret: &lt;input name=secret&gt;&lt;br&gt; &lt;input type=submit name=submit&gt; &lt;/form&gt; &lt;div id=&#34;viewsource&#34;&gt;&lt;a href=&#34;index-source.html&#34;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; Looking at the sourcecode, we see that there is an encoded secret stored in a variable $encodedSecret using php. Usually it would be difficult to discern the cleartext secret, but if we look at the code we can actually see how the secret is encoded. So let’s look at the steps taken in the function encodeSecret():">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="natas">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Level 8">
  <meta name="twitter:description" content="14:45:00&#43;01:00 draft = false &#43;&#43;&#43;
State “DONE” from [2025-03-27 Thu 14:45]&lt; Level 8 is a little tricky. We are asked to input a secret again and have a button showing the sourcecode. {{&lt; figure src=&#34;/ox-hugo/clipboard-20250224T233738.png&#34; &gt;}}
So let’s look at the sourcecode:
&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&#34;stylesheet&#34; type=&#34;text/css&#34; href=&#34;http://natas.labs.overthewire.org/css/level.css&#34;&gt; &lt;link rel=&#34;stylesheet&#34; href=&#34;http://natas.labs.overthewire.org/css/jquery-ui.css&#34; /&gt; &lt;link rel=&#34;stylesheet&#34; href=&#34;http://natas.labs.overthewire.org/css/wechall.css&#34; /&gt; &lt;script src=&#34;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&#34;&gt;&lt;/script&gt; &lt;script src=&#34;http://natas.labs.overthewire.org/js/jquery-ui.js&#34;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&#34;http://natas.labs.overthewire.org/js/wechall.js&#34;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &#34;level&#34;: &#34;natas8&#34;, &#34;pass&#34;: &#34;&lt;censored&gt;&#34; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas8&lt;/h1&gt; &lt;div id=&#34;content&#34;&gt; &lt;? $encodedSecret = &#34;3d3d516343746d4d6d6c315669563362&#34;; function encodeSecret($secret) { return bin2hex(strrev(base64_encode($secret))); } if(array_key_exists(&#34;submit&#34;, $_POST)) { if(encodeSecret($_POST[&#39;secret&#39;]) == $encodedSecret) { print &#34;Access granted. The password for natas9 is &lt;censored&gt;&#34;; } else { print &#34;Wrong secret&#34;; } } ?&gt; &lt;form method=post&gt; Input secret: &lt;input name=secret&gt;&lt;br&gt; &lt;input type=submit name=submit&gt; &lt;/form&gt; &lt;div id=&#34;viewsource&#34;&gt;&lt;a href=&#34;index-source.html&#34;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; Looking at the sourcecode, we see that there is an encoded secret stored in a variable $encodedSecret using php. Usually it would be difficult to discern the cleartext secret, but if we look at the code we can actually see how the secret is encoded. So let’s look at the steps taken in the function encodeSecret():">
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/natas/level8/" /><link rel="prev" href="http://localhost:1313/natas/level9/" /><link rel="next" href="http://localhost:1313/natas/level7/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Level 8",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/natas\/level8\/"
        },"genre": "natas","wordcount":  302 ,
        "url": "http:\/\/localhost:1313\/natas\/level8\/","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "xxxx"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="My New Hugo Site">My cool site</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="My New Hugo Site">My cool site</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">Level 8</h1><div class="content" id="content"><p>14:45:00+01:00
draft = false
+++</p>
<ul>
<li>State &ldquo;DONE&rdquo;       from              <!-- raw HTML omitted --><!-- raw HTML omitted -->[2025-03-27 Thu 14:45]&lt;<figure><img src="/ox-hugo/clipboard-20250224T233738.png">
</figure>

Level 8 is a little tricky. We are asked to input a secret again and have a button showing the sourcecode.</li>
</ul>
<p>{{&lt; figure src=&quot;/ox-hugo/clipboard-20250224T233738.png&quot; &gt;}}</p>
<p>So let&rsquo;s look at the sourcecode:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-web">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code class="language-web" data-lang="web">&lt;html&gt;
    &lt;head&gt;
        &lt;!-- This stuff in the header has nothing to do with the level --&gt;
        &lt;link rel=&#34;stylesheet&#34; type=&#34;text/css&#34; href=&#34;http://natas.labs.overthewire.org/css/level.css&#34;&gt;
        &lt;link rel=&#34;stylesheet&#34; href=&#34;http://natas.labs.overthewire.org/css/jquery-ui.css&#34; /&gt;
        &lt;link rel=&#34;stylesheet&#34; href=&#34;http://natas.labs.overthewire.org/css/wechall.css&#34; /&gt;
        &lt;script src=&#34;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&#34;&gt;&lt;/script&gt;
        &lt;script src=&#34;http://natas.labs.overthewire.org/js/jquery-ui.js&#34;&gt;&lt;/script&gt;
        &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&#34;http://natas.labs.overthewire.org/js/wechall.js&#34;&gt;&lt;/script&gt;
        &lt;script&gt;var wechallinfo = { &#34;level&#34;: &#34;natas8&#34;, &#34;pass&#34;: &#34;&lt;censored&gt;&#34; };&lt;/script&gt;&lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;natas8&lt;/h1&gt;
        &lt;div id=&#34;content&#34;&gt;

            &lt;?

            $encodedSecret = &#34;3d3d516343746d4d6d6c315669563362&#34;;

            function encodeSecret($secret) {
            return bin2hex(strrev(base64_encode($secret)));
            }

            if(array_key_exists(&#34;submit&#34;, $_POST)) {
            if(encodeSecret($_POST[&#39;secret&#39;]) == $encodedSecret) {
            print &#34;Access granted. The password for natas9 is &lt;censored&gt;&#34;;
            } else {
            print &#34;Wrong secret&#34;;
            }
            }
            ?&gt;
            &lt;form method=post&gt;
                Input secret: &lt;input name=secret&gt;&lt;br&gt;
                &lt;input type=submit name=submit&gt;
            &lt;/form&gt;

            &lt;div id=&#34;viewsource&#34;&gt;&lt;a href=&#34;index-source.html&#34;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre></div>
<p>Looking at the sourcecode, we see that there is an encoded secret stored in a variable <code>$encodedSecret</code> using php. Usually it would be difficult to discern the cleartext secret, but if we look at the code we can actually see how the secret is encoded. So let&rsquo;s look at the steps taken in the function <code>encodeSecret()</code>:</p>
<ol>
<li>bin2hex: searching for bin2hex, we can find this <a href="https://www.php.net/manual/de/function.bin2hex.php" target="_blank" rel="noopener noreffer ">site</a> which describes what the function does: <code>Returns an ASCII string containing the hexadecimal representation of string. The conversion is done byte-wise with the high-nibble first.</code> We also see that there is a reverse function <code>hex2bin()</code>. Using the code editor on its <a href="https://www.php.net/manual/en/function.hex2bin.php" target="_blank" rel="noopener noreffer ">site</a> we can reverse the encoding.</li>
<li>Next in line is the <code>strrev</code> function which just reverses a string. So re-reversing the string we can move to the next step.</li>
<li>Finally, <code>base64_encode</code> encodes a given string with base64. The corresponding <a href="https://www.php.net/manual/en/function.base64-decode.php" target="_blank" rel="noopener noreffer ">site</a> for <code>base64_decode</code> will let us use its code editor to input the reverted string</li>
</ol>
</div></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">xxxx</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script>window.config={"comment":{}};</script><script src="/js/theme.min.js"></script></body>
</html>
