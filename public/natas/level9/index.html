<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Level 9 - My New Hugo Site</title><meta name="Description" content="This is my cool site"><meta property="og:url" content="http://localhost:1313/natas/level9/">
  <meta property="og:site_name" content="My New Hugo Site">
  <meta property="og:title" content="Level 9">
  <meta property="og:description" content="14:45:00&#43;01:00 draft = false &#43;&#43;&#43;
State “DONE” from [2025-03-27 Thu e.org/&gt; Level 9 again presents a search box and a button to inspect the source code, see screenshot below.
{{&lt; figure src=&#34;/ox-hugo/clipboard-20250227T145045.png&#34; &gt;}}
Looking at the sourcecode, we find the following php code:
&lt;? $key = &#34;&#34;; if(array_key_exists(&#34;needle&#34;, $_REQUEST)) { $key = $_REQUEST[&#34;needle&#34;]; } if($key != &#34;&#34;) { passthru(&#34;grep -i $key dictionary.txt&#34;); } ?&gt; The code first takes the user input posted and stores it in a variable $key. It then checks if key is non-empty and passes the variable to the passthru() function. So let’s do some digging. A web search for the function gives us the following:">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="natas">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Level 9">
  <meta name="twitter:description" content="14:45:00&#43;01:00 draft = false &#43;&#43;&#43;
State “DONE” from [2025-03-27 Thu e.org/&gt; Level 9 again presents a search box and a button to inspect the source code, see screenshot below.
{{&lt; figure src=&#34;/ox-hugo/clipboard-20250227T145045.png&#34; &gt;}}
Looking at the sourcecode, we find the following php code:
&lt;? $key = &#34;&#34;; if(array_key_exists(&#34;needle&#34;, $_REQUEST)) { $key = $_REQUEST[&#34;needle&#34;]; } if($key != &#34;&#34;) { passthru(&#34;grep -i $key dictionary.txt&#34;); } ?&gt; The code first takes the user input posted and stores it in a variable $key. It then checks if key is non-empty and passes the variable to the passthru() function. So let’s do some digging. A web search for the function gives us the following:">
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/natas/level9/" /><link rel="next" href="http://localhost:1313/natas/level8/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Level 9",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/natas\/level9\/"
        },"genre": "natas","wordcount":  287 ,
        "url": "http:\/\/localhost:1313\/natas\/level9\/","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "xxxx"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="My New Hugo Site">My cool site</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="My New Hugo Site">My cool site</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">Level 9</h1><div class="content" id="content"><p>14:45:00+01:00
draft = false
+++</p>
<ul>
<li>State &ldquo;DONE&rdquo;       from              <!-- raw HTML omitted --><!-- raw HTML omitted -->[2025-03-27 Thu<figure><img src="/ox-hugo/clipboard-20250227T145045.png">
</figure>
e.org/&gt;</li>
</ul>
<p>Level 9 again presents a search box and a button to inspect the source code, see screenshot below.</p>
<p>{{&lt; figure src=&quot;/ox-hugo/clipboard-20250227T145045.png&quot; &gt;}}</p>
<p>Looking at the sourcecode, we find the following php code:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-web">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code class="language-web" data-lang="web">&lt;?
$key = &#34;&#34;;

if(array_key_exists(&#34;needle&#34;, $_REQUEST)) {
$key = $_REQUEST[&#34;needle&#34;];
}

if($key != &#34;&#34;) {
passthru(&#34;grep -i $key dictionary.txt&#34;);
}
?&gt;</code></pre></div>
<p>The code first takes the user input posted and stores it in a variable <code>$key</code>. It then checks if key is non-empty and passes the variable to the <code>passthru()</code> function. So let&rsquo;s do some digging. A web search for the function gives us the following:</p>
<blockquote>
<p>The passthru() function is similar to the exec() function in that it executes a command. This function should be used in place of exec() or system() when the output from the Unix command is binary data which needs to be passed directly back to the browser. A common use for this is to execute something like the pbmplus utilities that can output an image stream directly. By setting the Content-type to image/gif and then calling a pbmplus program to output a gif, you can create PHP scripts that output images directly.</p></blockquote>
<p>So it seems that the function takes an input and passes it through to the server. However, there is no mention of any sanitization being done - maybe we <figure><img src="/ox-hugo/clipboard-20250227T150331.png">
</figure>
some commands in our search box:</p>
<p>For example typing <code>test;ls;</code> into our search box gives us the following:</p>
<p>{{&lt; figure src=&quot;/ox-hugo/clipboard-20250227T150331.png&quot; &gt;}}</p>
<p>Wow, this worked! So it seems we can indeed <strong>inject</strong> co<figure><img src="/ox-hugo/clipboard-20250227T150852.png">
</figure>
e in <code>/etc/natas_webpass/</code>, so let&rsquo;s try and read the contents of the folder: `test;ls<figure><img src="/ox-hugo/clipboard-20250227T150954.png">
</figure>
0250227T150852.png&quot; &gt;}}</p>
<p>Cool, that also works. Now the final step:</p>
<p>`test</p>
</div></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">xxxx</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script>window.config={"comment":{}};</script><script src="/js/theme.min.js"></script></body>
</html>
